{"title":"KrakenD - Latency (Hist Counters)","description":"when the option is enable with\n```\nexporters:\n  datadog:\n    metrics:\n      histograms:\n        mode: counters\n        send_aggregation_metrics: true\n\n```","widgets":[{"id":1603690382063497,"definition":{"title":"KrakenD hits","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:http.server.duration.count{$service}.as_count()","aggregator":"sum"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":0,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":0,"width":2,"height":2}},{"id":8419795903868632,"definition":{"title":"Proxy hits","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:krakend.proxy.duration.count{$service}.as_count()","aggregator":"sum"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":0,"timeseries_background":{"type":"bars"}},"layout":{"x":2,"y":0,"width":2,"height":2}},{"id":5958000498742585,"definition":{"title":"Backend hits","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:krakend.backend.duration.count{$service}.as_count()","aggregator":"sum"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":0,"timeseries_background":{"type":"bars"}},"layout":{"x":4,"y":0,"width":2,"height":2}},{"id":4111532578225666,"definition":{"title":"HTTP Client hits","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:http.client.duration.count{$service}.as_count()","aggregator":"sum"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":0,"timeseries_background":{"type":"bars"}},"layout":{"x":6,"y":0,"width":2,"height":2}},{"id":6368214546239843,"definition":{"title":"Throughput (RPS) per endpoint","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"req/sec","number_format":{"unit":{"type":"canonical_unit","unit_name":"request","per_unit_name":"second"}},"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.count{$service} by {http.route,http.request.method}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":0,"width":4,"height":4}},{"id":6856740353231487,"definition":{"title":"Global Duration","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:http.server.duration.sum{$service}.as_rate()","aggregator":"avg"},{"name":"query2","data_source":"metrics","query":"sum:http.server.duration.count{$service}.as_rate()","aggregator":"avg"}],"formulas":[{"formula":"query1 / query2","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}}}]}],"autoscale":true,"precision":2,"timeseries_background":{"yaxis":{"include_zero":false},"type":"bars"}},"layout":{"x":0,"y":2,"width":2,"height":2}},{"id":2438645189891887,"definition":{"title":"Proxy Duration","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:krakend.proxy.duration.sum{$service}.as_rate()","aggregator":"avg"},{"name":"query2","data_source":"metrics","query":"sum:krakend.proxy.duration.count{$service}.as_rate()","aggregator":"avg"}],"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}]}],"autoscale":true,"precision":2,"timeseries_background":{"yaxis":{"include_zero":false},"type":"bars"}},"layout":{"x":2,"y":2,"width":2,"height":2}},{"id":3485690513688261,"definition":{"title":"Backend Duration","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:krakend.backend.duration.sum{$service}.as_rate()","aggregator":"avg"},{"name":"query2","data_source":"metrics","query":"sum:krakend.backend.duration.count{$service}.as_rate()","aggregator":"avg"}],"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}]}],"autoscale":true,"precision":2,"timeseries_background":{"yaxis":{"include_zero":false},"type":"bars"}},"layout":{"x":4,"y":2,"width":2,"height":2}},{"id":8817425824487255,"definition":{"title":"Client Duration","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:http.client.duration.sum{$service}.as_rate()","aggregator":"avg"},{"name":"query2","data_source":"metrics","query":"sum:http.client.duration.count{$service}.as_rate()","aggregator":"avg"}],"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}]}],"autoscale":true,"precision":2,"timeseries_background":{"yaxis":{"include_zero":false},"type":"bars"}},"layout":{"x":6,"y":2,"width":2,"height":2}},{"id":4399708440317303,"definition":{"title":"Server duration","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"style":{"palette":"warm","palette_index":6},"formula":"query1 / query2"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:http.server.duration.sum{$service}.as_count()"},{"name":"query2","data_source":"metrics","query":"sum:http.server.duration.count{$service}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":0,"y":4,"width":2,"height":2}},{"id":1707120969891009,"definition":{"title":"Proxy duration","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query2","data_source":"metrics","query":"sum:krakend.proxy.duration.sum{$service}.as_count()"},{"name":"query1","data_source":"metrics","query":"sum:krakend.proxy.duration.count{$service}.as_count()"}],"formulas":[{"style":{"palette":"warm","palette_index":3},"formula":"query2 / query1","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}}}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":2,"y":4,"width":2,"height":2}},{"id":6808081879962502,"definition":{"title":"Backend duration","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"metrics","query":"sum:krakend.backend.duration.sum{$service}.as_count()"},{"name":"query2","data_source":"metrics","query":"sum:krakend.backend.duration.count{$service}.as_count()"}],"formulas":[{"style":{"palette":"cool","palette_index":5},"formula":"query1 / query2","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}}}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":4,"y":4,"width":2,"height":2}},{"id":8828183804823005,"definition":{"title":"HTTP Client duration","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"metrics","query":"sum:http.client.duration.sum{$service}.as_count()"},{"name":"query2","data_source":"metrics","query":"sum:http.client.duration.count{$service}.as_count()"}],"formulas":[{"style":{"palette":"green","palette_index":5},"formula":"query1 / query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":6,"y":4,"width":2,"height":2}},{"id":1362389512379086,"definition":{"title":"Average response time","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.sum{http.route:$route.value AND (service:$service.value OR instance:$service.value)}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.duration.count{http.route:$route.value AND (service:$service.value OR instance:$service.value)}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":4,"width":4,"height":2}},{"id":8163806314062416,"definition":{"title":"Server hits","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query5","data_source":"metrics","query":"sum:http.server.duration.count{$service}.as_rate()"}],"formulas":[{"style":{"palette":"warm","palette_index":6},"formula":"query5"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":0,"y":6,"width":2,"height":2}},{"id":6885002052798743,"definition":{"title":"Proxy hits","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query5","data_source":"metrics","query":"sum:krakend.proxy.duration.count{$service}.as_rate()"}],"formulas":[{"style":{"palette":"warm","palette_index":3},"formula":"query5"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":2,"y":6,"width":2,"height":2}},{"id":2916685043396963,"definition":{"title":"Backend hits","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query5","data_source":"metrics","query":"sum:krakend.backend.duration.count{$service}.as_rate()"}],"formulas":[{"style":{"palette":"cool","palette_index":5},"formula":"query5"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":4,"y":6,"width":2,"height":2}},{"id":101990119786057,"definition":{"title":"Client hits","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query5","data_source":"metrics","query":"sum:http.client.duration.count{$service}.as_rate()"}],"formulas":[{"style":{"palette":"green","palette_index":5},"formula":"query5"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":6,"y":6,"width":2,"height":2}},{"id":7339873422125102,"definition":{"title":"Average response time per endpoint","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.sum{$service} by {http.route,http.request.method}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.duration.count{$service} by {http.route,http.request.method}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":6,"width":4,"height":4}},{"id":8671060779662261,"definition":{"title":"Status Codes Over Time","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query2"},{"formula":"query3"},{"formula":"query4"}],"queries":[{"query":"sum:http.server.duration.count{http.response.status_code:200,$service}.as_count()","data_source":"metrics","name":"query1"},{"query":"sum:http.server.duration.count{http.response.status_code:404,$service}.as_count()","data_source":"metrics","name":"query2"},{"query":"sum:http.server.duration.count{http.response.status_code:500,$service}.as_count()","data_source":"metrics","name":"query3"},{"query":"sum:http.server.duration.count{http.response.status_code:503,$service}.as_count()","data_source":"metrics","name":"query4"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"bars"}],"yaxis":{"scale":"linear","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":0,"y":8,"width":4,"height":2}},{"id":4255649569097639,"definition":{"title":"Status Codes Percentages","title_size":"16","title_align":"left","requests":[{"response_format":"scalar","queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.count{*} by {http.response.status_code}.as_count()","aggregator":"avg"}],"style":{"palette":"classic"},"formulas":[{"formula":"query1"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"type":"sunburst","legend":{"type":"table"}},"layout":{"x":4,"y":8,"width":4,"height":2}},{"id":48005317305570,"definition":{"title":"Global Duration Heatmap","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","markers":[],"yaxis":{"scale":"log","include_zero":false,"num_buckets":50,"min":"auto","max":"auto"},"requests":[{"request_type":"histogram","query":{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.bucket{$service, $route} by {upper_bound}.as_count()","histogram_mode":"pre_binned_metric"},"style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":10,"width":2,"height":2}},{"id":7849982497452142,"definition":{"title":"Proxy duration heatmap","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"include_zero":false,"scale":"log"},"requests":[{"request_type":"histogram","query":{"data_source":"metrics","name":"query1","query":"sum:krakend.proxy.duration.bucket{$service, $route} by {upper_bound}.as_count()","histogram_mode":"pre_binned_metric"}}]},"layout":{"x":2,"y":10,"width":2,"height":2}},{"id":1153475872488032,"definition":{"title":"Backend duration heatmap","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"include_zero":false,"scale":"log"},"requests":[{"request_type":"histogram","query":{"data_source":"metrics","name":"query1","query":"sum:http.client.duration.bucket{$service, $route} by {upper_bound}.as_count()","histogram_mode":"pre_binned_metric"}}]},"layout":{"x":4,"y":10,"width":2,"height":2}},{"id":6772050072022638,"definition":{"title":"Avg response time per endpoint (top 10)","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"data_source":"metrics","name":"query2","query":"sum:http.server.duration.sum{$service} by {http.route}.as_count()","aggregator":"avg"},{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.count{$service} by {http.route}.as_count()","aggregator":"avg"}],"response_format":"scalar","sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query2 / query1"}]}],"has_search_bar":"auto"},"layout":{"x":6,"y":10,"width":3,"height":4}},{"id":3582815543124081,"definition":{"title":"Avg response size per endpoint (to review)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"bytes/sec","formula":"query1 / query2","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_binary_bytes_family"}}}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.response.size.sum{http.route:$route.value} by {http.route}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.response.size.count{http.route:$route.value} by {http.route}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":9,"y":10,"width":3,"height":4}},{"id":1767757645996410,"definition":{"title":"Global Throughput (RPS)","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"req/sec","number_format":{"unit":{"type":"canonical_unit","unit_name":"request","per_unit_name":"second"}},"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"sum:http.server.duration.count{$service, $route}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":12,"width":2,"height":2}},{"id":1037807901195468,"definition":{"title":"Proxy Throughput (RPS)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"req/s","number_format":{"unit":{"type":"canonical_unit","unit_name":"request","per_unit_name":"second"}},"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:krakend.proxy.duration.count{$route, $service}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":2,"y":12,"width":2,"height":2}},{"id":4093792248517113,"definition":{"title":"Throughput (RPS)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"req/s","number_format":{"unit":{"type":"canonical_unit","unit_name":"request","per_unit_name":"second"}},"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.duration.count{$service, $route}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":12,"width":2,"height":2}},{"id":2021046946773786,"definition":{"title":"Global Avg Latency","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.sum{$service, $route}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.duration.count{$service, $route}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":14,"width":2,"height":3}},{"id":7767165431316007,"definition":{"title":"Proxy Avg Endpoint Latencies","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"seconds","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:krakend.proxy.duration.sum{$route, $service} by {http.request.method,http.route}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:krakend.proxy.duration.count{$route, $service} by {http.request.method,http.route}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":2,"y":14,"width":2,"height":3}},{"id":4586898474953800,"definition":{"title":"Backend Avg  latency","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"seconds","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.duration.sum{$service, $route} by {http.request.method,http.route,server.address}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.client.duration.count{$service, $route} by {http.request.method,http.route,server.address}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":14,"width":2,"height":3}},{"id":8427593803060133,"definition":{"title":"Response data size (payloads)","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / query2","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_binary_bytes_family"}}}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.response.size.sum{http.route:$route.value AND (service:$service.value OR instance:$service.value)}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.response.size.count{http.route:$route.value AND (service:$service.value OR instance:$service.value)}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":14,"width":6,"height":3}},{"id":8833299359382549,"definition":{"title":"Backend Content","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":7099485926742884,"definition":{"title":"Received Content Length","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_binary_bytes_family"}},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.response.size.sum{$route AND (service:$service.value OR instance:$service.value)}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.client.response.size.count{$route AND (service:$service.value OR instance:$service.value)}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":8243013401384980,"definition":{"title":"Response Status Codes Count","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.duration.count{$route AND (service:$service.value OR instance:$service.value)} by {http.response.status_code}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":7146162481075960,"definition":{"title":"Failed and Timed out","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.request.failed.count{$route AND (service:$service.value OR instance:$service.value)} by {http.response.status_code}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":6,"height":3}},{"id":2776689840044536,"definition":{"title":"Started vs Canceled","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"started","formula":"query1"},{"alias":"canceled","formula":"query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.request.started.count{$route AND (service:$service.value OR instance:$service.value)}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.client.request.canceled.count{$route AND (service:$service.value OR instance:$service.value)}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":3,"width":6,"height":3}},{"id":8815586339212001,"definition":{"title":"No Content Length Count","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"count","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.response.no_content_length{$route AND (service:$service.value OR instance:$service.value)}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":6,"width":6,"height":3}},{"id":3191760720748292,"definition":{"title":"Average Content Length","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_binary_bytes_family"}},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.client.response.size.sum{$route AND (service:$service.value OR instance:$service.value)}.as_rate()"},{"data_source":"metrics","name":"query2","query":"sum:http.client.response.size.count{$route AND (service:$service.value OR instance:$service.value)}.as_rate()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":6,"width":6,"height":3}}]},"layout":{"x":0,"y":0,"width":12,"height":10,"is_column_break":true}},{"id":2969039079398766,"definition":{"title":"Overhead (can be misleading: only makes sense for single backend endpoints)","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":6606592286998734,"definition":{"title":"Duration Compare","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"style":{"palette":"warm","palette_index":6},"formula":"query1 / query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.sum{$service}.as_count()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.duration.count{$service}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"},{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query0","query":"sum:krakend.proxy.duration.sum{$service}.as_count()"},{"data_source":"metrics","name":"query1","query":"sum:krakend.proxy.duration.count{$service}.as_count()"}],"formulas":[{"style":{"palette":"warm","palette_index":3},"formula":"query0 / query1","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}}}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"},{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query0","query":"sum:krakend.backend.duration.sum{$service}.as_count()"},{"data_source":"metrics","name":"query1","query":"sum:krakend.backend.duration.count{$service}.as_count()"}],"formulas":[{"style":{"palette":"cool","palette_index":5},"formula":"query0 / query1","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}}}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"},{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query0","query":"sum:http.client.duration.sum{$service}.as_count()"},{"data_source":"metrics","name":"query1","query":"sum:http.client.duration.count{$service}.as_count()"}],"formulas":[{"style":{"palette":"green","palette_index":5},"formula":"query0 / query1","number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}}}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":0,"y":0,"width":12,"height":2}},{"id":5807145479442430,"definition":{"title":"Overhead","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"second"}},"style":{"palette":"gray","palette_index":3},"alias":"total overhead","formula":"(query1 / query2) - (query3 / query4)"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:http.server.duration.sum{$service}.as_count()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.duration.count{$service}.as_count()"},{"data_source":"metrics","name":"query3","query":"sum:http.client.duration.sum{$service}.as_count()"},{"data_source":"metrics","name":"query4","query":"sum:http.client.duration.count{$service}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":0,"y":2,"width":12,"height":3}}]},"layout":{"x":0,"y":10,"width":12,"height":1}}],"template_variables":[{"name":"service","prefix":"service","available_values":[],"default":"*"},{"name":"route","prefix":"http.route","available_values":[],"default":"*"}],"layout_type":"ordered","notify_list":[],"reflow_type":"fixed"}